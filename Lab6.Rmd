---
title: "Lab 6"
author: "Rich Chu, Lorena Mancino, Fatima Gohar"
output: html_notebook
---

# Lab 6: Nothing Is Normal About This!

### Problem 0 

https://github.com/RichChu1/ma350_lab6

## Part I: The Rightful pgauss()

### Problem 1

```{r}
#' computes the cumulative distribution function for a Gaussian random variable using integrate 
#'
#' @param x a vector
#' @param mean the mean with default value of 0
#' @param var the variance with default value of 1
#'
#' @return returns the cumulative distribution function evaluated at all of the values in x 


pgauss <- function(x, mean = 0, var = 1){
  cdf <- rep(0, length(x))
  for (i in 1:length(x)){
    cdf[i] <- integrate(f = function(x) dnorm(x, mean = mean, sd = sqrt(var)), lower = -Inf, upper = x[i])[[1]]
  }
  return(cdf)
}
```

### Problem 2

```{r}
pgauss(3,1,2)
pnorm(3, mean = 1, sd = sqrt(2))
```
The values of pgauss and pnorm are the same, meaning that the function works. 


## Part II: What's a Normal Score?

### Problem 3

```{r}
curve(pnorm(x, mean = 5, sd = sqrt(100)), from = -30, to = 30)
abline(v=qnorm(0.25, mean=5, sd=sqrt(100)), col='red')
```

### Problem 4

```{r}
#' computes the quantile function for a Gaussian random variable 
#'
#' @param q a vector 
#' @param mean the mean with a default value of 0
#' @param var the variance with a default value of 1
#'
#' @return returns the quantile function evaluated at all of the values in q


qgauss <- function(q, mean = 0, var = 1){
  quant.function <- rep(0, length(q))
  for (i in 1:length(q)){
    f <- function(x) pgauss(x, mean, var) - q[i]
    quant.function[i] <- uniroot(f, c(mean - 3*sqrt(var), mean+3*sqrt(var)))[[1]]
  }
  return(quant.function)
  
}

```

### Problem 5

```{r}
qgauss(0.25, 5, 100)
qnorm(0.25, mean = 5, sd = sqrt(100))
```
Yes, our answer matches the graphical solution to the problem we found in 3. 


## Part III: What's the Most Likely Mean?

### Problem 6

```{r}
#' computes the log-likelihood for a Gaussian random sample
#' 
#' @param mean the presumed mean 
#' @param var the assumed variance 
#' @param data a vector containing the sample x1 to xn
#' 
#' @return returns the log-likelihood of data 


gaussian.ll <- function(mean, var, data){
  log.likelihood <- (-((length(data)/2)*log(2*pi*var)))-(-(1/(2*var))*sum((data-mean)^2))
return(log.likelihood)
}

```

### Problem 7

```{r}
gaussian.ll.v <- Vectorize(gaussian.ll, vectorize.args = 'mean')
```

### Problem 8 

```{r}
set.seed(1)

x <- rnorm(100, mean = 0, sd = 1)
curve(gaussian.ll.v(mean, 1, x), from=-5, to=5, xname = 'mean')
```
The mean maximizes at approximately 0, which makes sense because that's what we set mean to be. 

### Problem 9

```{r}
optimize(f = gaussian.ll.v, var=1, data = X, interval = c(-10, 10), maximum=TRUE)

mean(X)
```
The maximizing value is -9.999. 

```{r}
curve(gaussian.ll.v(mean, 1, x), from=-5, to=5, xname = 'mean')
abline(h=-9.999)
```

### Problem 10 

```{r}
mean(X)
```
The means match because they have the same X. 





















